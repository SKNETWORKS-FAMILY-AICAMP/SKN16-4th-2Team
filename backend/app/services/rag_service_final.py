"""
ìµœì¢… RAG ì„œë¹„ìŠ¤ - SQL ì˜¤ë¥˜ ì—†ì´ í™•ì‹¤í•˜ê²Œ ì‘ë™
"""
import os
import requests
import json
from typing import Dict, List, Optional
from sqlalchemy.orm import Session
from sqlalchemy import text

class FinalRAGService:
    def __init__(self, session: Session):
        self.session = session
        self.api_key = os.getenv("OPENAI_API_KEY")
        self.base_url = "https://api.openai.com/v1"
        
        # ë¬¸ì„œ ì œëª© ë¦¬ìŠ¤íŠ¸ (ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ëª¨ë“  ì œëª©)
        self.document_titles = [
            "ìœ„ì„ì¥", "ì‹ ìš©ë³´ì¦ì„œ", "ì´ì˜ì‹ ì²­ì„œ", "ëŒ€ìœ„ë³€ì œì¦ì„œ", "ëŒ€ì¶œë§Œê¸°ì•ˆë‚´", "ë¯¼ì›ì ‘ìˆ˜ì–‘ì‹", "ì œì¦ëª…ì˜ë¢°ì„œ",
            "ê±°ì¹˜ì‹ì˜ˆê¸ˆì•½ê´€", "ê³ ê°ê¶Œë¦¬ì•ˆë‚´ë¬¸", "ìˆ˜ì‹ ê±°ë˜ìƒí™©í‘œ", "ì‹ ìš©ë³´ì¦ì•½ì •ì„œ", "ì—¬ì‹ ê±°ë˜ìƒí™©í‘œ",
            "ì´ì˜ì œê¸°ì‹ ì²­ì„œ", "ì´ìê³„ì‚°ë‚´ì—­ì„œ", "ìë£Œì—´ëŒìš”êµ¬ì„œ", "ì”ì¡´ì±„ë¬´í™•ì¸ì„œ", "ì ë¦½ì‹ì˜ˆê¸ˆì•½ê´€",
            "í”¼í•´êµ¬ì œì‹ ì²­ì„œ", "ëŒ€ì¶œë§Œê¸°ê²½ê³¼ì•ˆë‚´", "ì˜ˆê¸ˆê±°ë˜ê¸°ë³¸ì•½ê´€", "ì „ì„¸ì§€í‚´ë³´ì¦ì•½ê´€",
            "ì±„ê¶Œìê³„ì¢Œì‹ ê³ ì„œ", "ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ê¸°ì—…ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ë³´ì¦ì±„ë¬´ì´í–‰ì²­êµ¬ì„œ",
            "ë¹„ê³¼ì„¸ì¢…í•©ì €ì¶•íŠ¹ì•½", "ì‹ ìš©ë³´ì¦ë¶€ì‹¤í†µì§€ì„œ", "ì „ìê¸ˆìœµê±°ë˜ê¸°ë³¸ì•½ê´€",
            "ì€í–‰ì—¬ì‹ ê±°ë˜ê¸°ë³¸ì•½ê´€(í•¨ê»˜ëŒ€ì¶œìš©)", "ì€í–‰ì—¬ì‹ ê±°ë˜ê¸°ë³¸ì•½ê´€(ê°€ê³„ìš©)", "ì€í–‰ì—¬ì‹ ê±°ë˜ê¸°ë³¸ì•½ê´€(ê¸°ì—…ìš©)",
            "ì „ìê¸ˆìœµê±°ë˜ê¸°ë³¸ì•½ê´€(ê¸°ì—…ìš©)", "ì…ì¶œê¸ˆì´ììœ ë¡œìš´ì˜ˆê¸ˆ_ì•½ê´€", "ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ(í•¨ê»˜ëŒ€ì¶œìš©)",
            "ì¦ê¶Œê³„ì¢Œê°œì„¤ì„œë¹„ìŠ¤+ì„¤ëª…ì„œ", "ê³„ì¢Œí†µí•©ê´€ë¦¬ì„œë¹„ìŠ¤+ì´ìš©ì•½ê´€", "ì¦ê¶Œê³„ì¢Œê°œì„¤ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ+ìƒí’ˆì„¤ëª…ì„œ", "ìœ„ì„ì¥(ê°œì¸ì—¬ì‹ )", "ìœ„ì„ì¥(ê¸ˆê²°ì›+ëŒ€ì¶œì´ë™ì‹œìŠ¤í…œ)", 
            "ìœ„ì„ì¥+(ì „ì›”ì„¸ëŒ€ì¶œ+ì‹¬ì‚¬ìš©)", "ìœ„ì„ì¥+(ìƒì†)",
            # ì¶”ê°€ëœ ëª¨ë“  ì œëª©ë“¤
            "ì „ê¸°í†µì‹ ê¸ˆìœµì‚¬ê¸°+í”¼í•´êµ¬ì œì‹ ì²­ì„œ+ì¢…í•©+ì„œë¥˜", "ì „ê¸°í†µì‹ ê¸ˆìœµì‚¬ê¸°+ì „í™”ë²ˆí˜¸+ë“±+ì‹ ê³ ",
            "ëŒ€ì¶œì´ë™ì‹œìŠ¤í…œì„_í†µí•œ_ëŒ€í™˜ëŒ€ì¶œì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ëŒ€ì¶œì´ë™ì‹œìŠ¤í…œì„_í†µí•œ__ì „ì„¸ëŒ€ì¶œ_ëŒ€í™˜ëŒ€ì¶œì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "ì •ë³´ë³€ê²½ì‹ ì²­ì„œ(ì „ê¸°í†µì‹ ê¸ˆìœµì‚¬ê¸°ê´€ë ¨)", "ìê¸ˆë°˜í™˜ë™ì˜ì„œ(ì „ê¸°í†µì‹ ê¸ˆìœµì‚¬ê¸°+ê´€ë ¨)(ì§€ê¸‰ì²­êµ¬ì„œ+ê²¸ìš©)",
            "ì‹ ìš©ë³´ì¦ì‹ ì²­ì„œ(ì„œë¯¼ê¸ˆìœµì§„í¥ì›)", "í”¼í•´êµ¬ì œì‹ ì²­ì„œ(ì‘ì„±ì˜ˆì‹œë³¸)",
            "ì‹ ìš©ë³´ì¦ì•½ì •ì„œ(ê°œë³„ê±°ë˜ìš©-ë¹„ëŒ€ë©´)_[ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ]", "ì‚¬ì¥ë‹˜ëŒ€í™˜ëŒ€ì¶œ(ê°±ì‹ ë³´ì¦)+ìƒí’ˆì•ˆë‚´",
            "ì‹ ìš©ë³´ì¦ì•½ì •ì„œ(ê°œë³„ê±°ë˜-ê°œë³„ë³´ì¦ìš©)_[ì‹ ìš©ë³´ì¦ì¬ë‹¨]", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ(ê°€ê³„ìš©)", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ(ê¸°ì—…ìš©)",
            "ê³ ê°ê±°ë˜í™•ì¸ì„œ(ê°œì¸)", "ì€í–‰ê±°ë˜ì‹ ì²­ì„œ(ë²•ì¸)", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ(ì›ê¸ˆ_ìë™ìƒí™˜ìš©)",
            "ê³ ê°ê±°ë˜í™•ì¸ì„œ(ë²•ì¸_ë‹¨ì²´)", "ê³„ì¢Œì´ë™ì„œë¹„ìŠ¤+ì´ìš©ì•½ê´€", "ê±°ë˜ì™¸êµ­í™˜ì€í–‰+ì§€ì •(ë³€ê²½)+ì‹ ì²­ì„œ+",
            "ì¹´ë“œì´ë™ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ì‹ ìš©ë³´ì¦ì‹ ì²­ì„œ_(í•œêµ­ì£¼íƒê¸ˆìœµê³µì‚¬)",
            "ìˆ˜ì¶œì‹ ìš©ë³´ì¦(ì„ ì ì „)_ìˆ˜ì¶œìš©ì›ìì¬_ìˆ˜ì…ì‹ ìš©ë³´ì¦_ì•½ì •ì„œ_[í•œêµ­ë¬´ì—­ë³´í—˜ê³µì‚¬]",
            "ê³ ê°í™•ì¸ì œë„+ì•ˆë‚´ë¬¸", "ê¸°íšŒë³´ì¦ëŒ€ì¶œ+ìƒí’ˆì•ˆë‚´", "ëŒ€ì¶œê³„ì¢Œì›ì¥+ê±°ë˜ë‚´ì—­", "ìš°ëŒ€ë³´ì¦ëŒ€ì¶œ+ìƒí’ˆì•ˆë‚´",
            "êµ­ë‚´ì›ì²œì†Œë“+ì œí•œì„¸ìœ¨+ì ìš©ì‹ ì²­ì„œ(ë¹„ê±°ì£¼ììš©)", "ë‹¤ì´ë ‰íŠ¸ë³´ì¦+ìƒí’ˆ+ì„¤ëª…ì„œ+[í•œêµ­ë¬´ì—­ë³´í—˜ê³µì‚¬]+",
            "ê¸ˆìœµê±°ë˜ì •ë³´+ì œê³µ+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ì•„ì´+ì„œë¹„ìŠ¤]", "ê¸ˆìœµê±°ë˜ì •ë³´+ì œê³µ+ë™ì˜ì„œ+[ì—°ì²´ê¸ˆ+ìë™ì¶©ì „+ì„œë¹„ìŠ¤]",
            "ê¸ˆìœµê±°ë˜ì •ë³´+ì œê³µ+ë™ì˜ì„œ+[ì±„ìš°ê¸°+ì†¡ê¸ˆ+ì„œë¹„ìŠ¤]", "ì™¸í™”ì˜ˆê¸ˆê±°ë˜_ê¸°ë³¸ì•½ê´€",
            "í›„ë¶ˆêµí†µì¹´ë“œ_ì´ìš©ì•½ê´€_(í•˜ë‚˜ì¹´ë“œ)", "ì „ì„¸ì§€í‚´ë³´ì¦_ì‹ ì²­ì„œ(í•œêµ­ì£¼íƒê¸ˆìœµê³µì‚¬)",
            "ì „ì„¸ì§€í‚´ë³´ì¦_í™•ì•½ì„œ(í•œêµ­ì£¼íƒê¸ˆìœµê³µì‚¬)", "ë“±ê¸°ë³€ë™ì•Œë¦¼_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "í–‡ì‚´ë¡ ë±…í¬ì—_ë”°ë¥¸_ì¶”ê°€ì•½ì •ì„œ", "ì§€ê¸‰ì²­êµ¬ì„œ(ê°œì¸)", "ì§€ê¸‰ì²­êµ¬ì„œ(ë²•ì¸)", "ì±„ê¶Œê³„ì‚°ì„œ(ê²½ë§¤)",
            "ë³´ì´ìŠ¤í”¼ì‹±+í”¼í•´ì˜ˆë°©+ë¬¸ì§„í‘œ", "ëª¨ë°”ì¼ë±…í‚¹+ì„œë¹„ìŠ¤+ì„¤ëª…ì„œ", "ë²•ì •ëŒ€ë¦¬ì¸+ì¸ì¦+ìë™í™”+ì„œë¹„ìŠ¤+ì´ìš©+ë™ì˜+ì‹ ì²­ì„œ",
            "ê³µë™ëª…ì˜ì¸+í™•ì¸+ë°+ë™ì˜ì„œ", "ìœ„ì´‰ì¦ëª…ì„œ+(ì „ì›”ì„¸ëŒ€ì¶œ+ì‹¬ì‚¬ìš©)", "í•´ì´‰ì¦ëª…ì„œ+(ì „ì›”ì„¸ëŒ€ì¶œ+ì‹¬ì‚¬ìš©)",
            "í–‡ì‚´ë¡ ë±…í¬_ì‹ ìš©ë³´ì¦ì•½ê´€", "ìë™í™˜ì „ì‹œ_ë¶€ì¡±í•œëˆ_ìë™ì¶©ì „_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ëª¨ë°”ì¼ë±…í‚¹_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "ìë™ì´ì²´(ë‚©ë¶€)_ì•½ê´€", "ìë™ì´ì²´(ì†¡ê¸ˆ)_ì•½ê´€", "í”¼í•´êµ¬ì œ+ì·¨ì†Œì‹ ì²­ì„œ",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(ì‚¬ì¥ë‹˜ìƒˆë‚ ëŒ€ì¶œìš©)", "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(ì´ì°¨ë³´ì „ëŒ€ì¶œìš©)",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(ë‹¹í–‰ëŒ€í™˜ìš©)", "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(ëŒ€í™˜ëŒ€ì¶œìš©)",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(í•¨ê»˜ëŒ€ì¶œ+ì¡°ê±´ë³€ê²½ìš©)", "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(í•¨ê»˜ëŒ€ì¶œ+ê³ ì•¡+ì‹ ìš©ëŒ€ì¶œì˜+ì‚¬í›„+ìš©ë„ê´€ë¦¬ìš©)",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(ê³ ì•¡+ì‹ ìš©ëŒ€ì¶œ+ì‚¬í›„+ìš©ë„ê´€ë¦¬ìš©)", "í† ìŠ¤ë±…í¬+ë‚˜ëˆ ëª¨ìœ¼ê¸°+í†µì¥+ìƒí’ˆì„¤ëª…ì„œ",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ+(ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œìš©)", "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ+(í•¨ê»˜ëŒ€ì¶œìš©)",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ+(ê°€ê³„ìš©)", "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ+(ê¸°ì—…ìš©)",
            "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ+(ì£¼íƒ+ì·¨ë“+ì œí•œ+ë“±ì—+ëŒ€í•œ+ì „ì„¸ìê¸ˆëŒ€ì¶œ+ì¶”ê°€ì•½ì •ìš©)",
            "í† ìŠ¤ë±…í¬+ë„ì „í†µì¥+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ëª¨ì„ê¸ˆê³ +ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ì™¸í™”í†µì¥+ìƒí’ˆì„¤ëª…ì„œ",
            "í† ìŠ¤ë±…í¬+ëª¨ì„í†µì¥+ìƒí’ˆì„¤ëª…ì„œ+", "í† ìŠ¤ë±…í¬+ëª¨ì„ì¹´ë“œ+í”„ë¡œëª¨ì…˜+í˜œíƒ+ì•ˆë‚´ì¥",
            "í† ìŠ¤ë±…í¬+ëª¨ì„í†µì¥+ì„œë¹„ìŠ¤+ì„¤ëª…ì„œ+", "ê°œì¸ì •ë³´+ë…¸ì¶œì‚¬ì‹¤+í•´ì œ+ì‹ ì²­ì„œ",
            "ì „ìê¸ˆìœµ+ì´ì²´í•œë„+ì¦ì•¡+ì‹ ì²­ì„œ", "í† ìŠ¤ë±…í¬+í‚¤ì›Œë´ìš”+ì ê¸ˆ+ìƒí’ˆì„¤ëª…ì„œ+",
            "ê¸ˆìœµê±°ë˜+ì •ë³´ì œê³µ+ìš”êµ¬Â·ë™ì˜ì„œ", "ëŒ€ì¶œì •ë³´+ì—´ëŒì²­êµ¬+ë°+ìƒí™˜+ìœ„ì„ì¥(ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ)",
            "ëŒ€ì¶œê±°ë˜+ì•½ì •ì„œ(í•¨ê»˜ëŒ€ì¶œìš©)", "ì •ê¸°ì ì¸+ì¦ëª…ì„œ+ë°œê¸‰+ì‹ ì²­ì„œ+",
            "ëŒ€ì¶œê±°ë˜+ì•½ì •ì„œ+(ê°€ê³„ëŒ€ì¶œ+ê¸ˆë¦¬ìš°ëŒ€ìš©)", "ë¯¸ì„±ë…„ì+ì—…ë¬´+ìš”ì²­ì„œ", "í† ìŠ¤ë±…í¬+í†µì¥+ìƒí’ˆì„¤ëª…ì„œ",
            "í† ìŠ¤ë±…í¬+ë²•ì¸+ì •ê¸°ì˜ˆê¸ˆ+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ì•„ì´+ì„œë¹„ìŠ¤+ì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ê²Œì„+ì €ê¸ˆí†µ+ìƒí’ˆì„¤ëª…ì„œ",
            "ê¸ˆìœµê±°ë˜+ëª©ì +í™•ì¸ì„œ+(ë²•ì¸)", "í† ìŠ¤ë±…í¬+ë²•ì¸+í†µì¥(ì œíœ´)+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+êµ´ë¹„+ì ê¸ˆ+ìƒí’ˆì„¤ëª…ì„œ",
            "í† ìŠ¤ë±…í¬+ë²•ì¸+í†µì¥+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ì„œë¸Œ+í†µì¥+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ì•„ì´+ì ê¸ˆ+ìƒí’ˆì„¤ëª…ì„œ",
            "í† ìŠ¤ë±…í¬+ì•„ì´+í†µì¥+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ììœ +ì ê¸ˆ+ìƒí’ˆì„¤ëª…ì„œ", "í† ìŠ¤ë±…í¬+ì´ì+ë°›ëŠ”+ì €ê¸ˆí†µ+ìƒí’ˆì„¤ëª…ì„œ",
            "í† ìŠ¤ë±…í¬+ë¨¼ì €+ì´ì+ë°›ëŠ”+ì •ê¸°ì˜ˆê¸ˆ+ìƒí’ˆì„¤ëª…ì„œ", "ê¸°ì´ˆì •ë³´+ì •ì •Â·ì‚­ì œ+ë°+ìë™í™”í‰ê°€+ì¬ì‚°ì¶œ+ìš”ì²­ì„œ",
            "ê°œì¸ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë°+ì œê³µ+ë™ì˜ì„œ+[ì˜¤í”ˆë±…í‚¹]+", "ê°œì¸ì •ë³´+ìˆ˜ì§‘ãƒ»ì´ìš©+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ë„ì „ì„œë¹„ìŠ¤]",
            "ê°œì¸ì •ë³´+ìˆ˜ì§‘ãƒ»ì´ìš©+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+í•¨ê»˜+ì‘ì›í•˜ê¸°+ì„œë¹„ìŠ¤]", "ê°œì¸ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ì‚¬ì§„+ì˜¬ë¦¬ê¸°+ê¸°ëŠ¥+ì´ìš©]",
            "í˜„ê¸ˆì¹´ë“œ_ì•½ê´€", "ì´ì²´í•œë„_ì¶”ê°€ì•½ì •ì„œ", "í† ìŠ¤ë±…í¬_ë„ì „ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "í† ìŠ¤ë±…í¬_ê¸ˆìœµì½˜í…ì¸ _êµ¬ë…ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "í† ìŠ¤ë±…í¬_ë‚˜ëˆ ëª¨ìœ¼ê¸°_í†µì¥_íŠ¹ì•½",
            "ì²´í¬ì¹´ë“œ_ê°œì¸íšŒì›_ì•½ê´€", "í† ìŠ¤ë±…í¬_ë„ì „í†µì¥_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ëª¨ì„ê¸ˆê³ _íŠ¹ì•½",
            "í† ìŠ¤ë±…í¬_ëª¨ì„í†µì¥_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ì™¸í™”í†µì¥_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ëª¨ì„ì¹´ë“œ_ìƒí’ˆì•½ê´€",
            "í† ìŠ¤ë±…í¬_ëª¨ì„ì¹´ë“œ_ì´ìš©ì•½ê´€", "í† ìŠ¤ë±…í¬_ì²´í¬ì¹´ë“œ_ìƒí’ˆì•½ê´€", "í† ìŠ¤ë±…í¬_ëª¨ì„í†µì¥_ì„œë¹„ìŠ¤ì´ìš©ì•½ê´€",
            "ì˜¤í”ˆë±…í‚¹_ê³µë™ì—…ë¬´_ê¸ˆìœµì •ë³´ì¡°íšŒ_ì•½ê´€", "ì˜¤í”ˆë±…í‚¹_ê³µë™ì—…ë¬´_ìë™ê³„ì¢Œì´ì²´_ì•½ê´€",
            "í† ìŠ¤ë±…í¬_ì™¸í™”í†µì¥_ë¶€ê°€ì„œë¹„ìŠ¤_íŠ¹ì•½", "ì˜¤í”ˆë±…í‚¹_ìë™ì´ì²´_ì—°ì²´ë°©ì§€_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "í† ìŠ¤ë±…í¬_ê¸°ì—…ë±…í‚¹_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "í† ìŠ¤ë±…í¬_íˆ¬ìì†Œì‹_êµ¬ë…_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "í† ìŠ¤ë±…í¬_í‚¤ì›Œë´ìš”_ì ê¸ˆ_íŠ¹ì•½_", "ì˜¤í”ˆë±…í‚¹_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ìœ„ì¹˜ê¸°ë°˜_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "ì»¤ë®¤ë‹ˆí‹°_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ì†Œìƒê³µì¸_ì €ê¸ˆë¦¬_ëŒ€í™˜ëŒ€ì¶œ_ì‹ ìš©ë³´ì¦ì•½ì •_ì„¤ëª…ì„œ(ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ)",
            "í† ìŠ¤ë±…í¬_í†µì¥_íŠ¹ì•½", "ì±„ë¬´ìƒí™˜_ì¡°ì •_ì•½ì •ì„œ", "í† ìŠ¤ë±…í¬_í•¨ê»˜_ì‘ì›í•˜ê¸°_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "í† ìŠ¤ë±…í¬_ë²•ì¸_ì •ê¸°ì˜ˆê¸ˆ__íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ê²Œì„_ì €ê¸ˆí†µ_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ì•„ì´_ì„œë¹„ìŠ¤_ì´ìš©_ì•½ê´€",
            "í† ìŠ¤ë±…í¬_ì•„ì´_ì„œë¹„ìŠ¤_ì´ìš©_ì•½ê´€(ë¶€ëª¨ìš©)", "í† ìŠ¤ë±…í¬_ë²•ì¸_í†µì¥(ì œíœ´)_íŠ¹ì•½",
            "í† ìŠ¤ë±…í¬_êµ´ë¹„_ì ê¸ˆ_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ë²•ì¸_í†µì¥_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ì„œë¸Œ_í†µì¥_íŠ¹ì•½",
            "í† ìŠ¤ë±…í¬_ì•„ì´_ì ê¸ˆ_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ì•„ì´_í†µì¥_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ììœ _ì ê¸ˆ_íŠ¹ì•½",
            "í† ìŠ¤ë±…í¬_ì´ì_ë°›ëŠ”_ì €ê¸ˆí†µ_íŠ¹ì•½", "í† ìŠ¤ë±…í¬_ëª¨ì„_ì •ì‚°_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "í† ìŠ¤ë±…í¬_ë¨¼ì €_ì´ì_ë°›ëŠ”_ì •ê¸°ì˜ˆê¸ˆ_íŠ¹ì•½", "ìœ„ì„ì¥(ê°œì¸ì—¬ì‹ )", "ìœ„ì„ì¥(ê¸ˆê²°ì›+ëŒ€ì¶œì´ë™ì‹œìŠ¤í…œ)",
            "ê´€ë¦¬ë¹„+ìë™ì´ì²´(ë‚©ë¶€)+ì•½ê´€", "ë¹„ëŒ€ë©´+ê¸ˆìœµì‚¬ê³ +ë¬¸ì§„í‘œ", "ëŒ€ì¶œê¸ˆ+ìƒí™˜ì‹ ì²­+ëª…ì„¸ì„œ_í™•ì¸",
            "ë¹„ëŒ€ë©´+ê¸ˆìœµì‚¬ê³ +ì¡°ì‚¬+ì‹ ì²­ì„œ+(ìˆ˜ê¸°ìš©)", "ì œì‹ ê³ +ë°+ë³€ê²½+ì˜ë¢°ì„œ", "ìœ„ì„ì¥+(ì „ì›”ì„¸ëŒ€ì¶œ+ì‹¬ì‚¬ìš©)",
            "ìœ„ì„ì¥+(ìƒì†)", "ë²•ì¸ìš©_ì¸í„°ë„·ë±…í‚¹_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ì—°ì²´ê¸ˆ_ìë™ì¶©ì „_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ì„ íƒì +ì œê³µ+ë™ì˜+(ë¶€ì •+ì‚¬ìš©+ë°©ì§€)+(ì„ íƒ)", "ê°œì¸(ì‹ ìš©)ì •ë³´+ë™ì˜ì„œ+ë°+ë‚˜ì˜+í–‰ì •ì •ë³´+í† ìŠ¤ë±…í¬+ì œê³µ+ìš”ì²­ì„œ+[ê³µê³µë§ˆì´ë°ì´í„°]+(ìˆ˜ì‹ )",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ì¡°íšŒ+ë™ì˜ì„œ++[ê³µê³µ+ë§ˆì´ë°ì´í„°]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘+ì´ìš©+ë™ì˜ì„œ(ê¸ˆìœµê²°ì œì›+ëŒ€ì¶œì´ë™ì‹œìŠ¤í…œ)",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ(í† ìŠ¤ë±…í¬+ê¸ˆìœµì½˜í…ì¸ +êµ¬ë…+ì„œë¹„ìŠ¤)", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ê³„ì¢Œí†µí•©ê´€ë¦¬ì„œë¹„ìŠ¤]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ì—°ì²´ê¸ˆ+ìë™ì¶©ì „+ì„œë¹„ìŠ¤]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ë¹„ì—¬ì‹ +ê¸ˆìœµê±°ë˜]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ[ëŒ€í™˜ëŒ€ì¶œ+ìŠ¤í¬ë˜í•‘]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ[ì±„ìš°ê¸°+ì†¡ê¸ˆ]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ[ëŒ€ë¦¬ì¸](í•„ìˆ˜)", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ(í•¨ê»˜ëŒ€ì¶œ)",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+(ì²´í¬ì¹´ë“œ_ë¹„êµí†µ)+", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ+ë°°ìš°ì]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ì—¬ì‹ ê¸ˆìœµê±°ë˜]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ì£¼íƒë³´ìœ ìˆ˜+í™•ì¸+ë“±]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ê¶Œë¦¬ë³´í—˜ìš©]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ì„œë¹„ìŠ¤+ì¶œê¸ˆì´ì²´]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ì†¡ê¸ˆ+ì„œë¹„ìŠ¤]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ[ì œíœ´ëŒ€í™˜ëŒ€ì¶œ]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ[ìƒí’ˆì„œë¹„ìŠ¤+ì•ˆë‚´+ë“±]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µÂ·ì¡°íšŒ+ë™ì˜ì„œ", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µÂ·ì¡°íšŒ+ë™ì˜ì„œ(ëŒ€ì•ˆì •ë³´+í™œìš©)",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µÂ·ì¡°íšŒ+ë™ì˜ì„œ+[í›„ë¶ˆ+êµí†µì¹´ë“œ]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µÂ·+ë™ì˜+(ì²´í¬ì¹´ë“œ_êµí†µ)+",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘ãƒ»ì´ìš©+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ê°™ì´+ë•ì§ˆí•˜ê¸°+ì„œë¹„ìŠ¤]", "ë‚˜ì˜+í–‰ì •ì •ë³´+í† ìŠ¤ë±…í¬+ì œê³µ+ìš”ì²­ì„œ[ê³µê³µë§ˆì´ë°ì´í„°]_ì—¬ì‹ _ì •ê¸°ì ì „ì†¡ë¯¸í¬í•¨",
            "ê³„ì•½+í•´ì§€+ìš”êµ¬ì„œ", "ê³„ì•½+ì²´ê²°Â·ì´í–‰+ë“±ì„+ìœ„í•œ+í•„ìˆ˜+ë™ì˜ì„œ+[ë³´ì´ìŠ¤í”¼ì‹±ì‹ ìš©ë³´í—˜ìš©]",
            "ì¹´ë“œ_ê²°ì œ_ë¶€ì¡±ê¸ˆì•¡_ìë™_ì±„ìš°ê¸°_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "í‹°ëª¬â€§ìœ„ë©”í”„+ì •ì‚°ì§€ì—°+í”¼í•´ê¸°ì—…+í™•ì•½ì„œ",
            "í‹°ëª¬â€§ìœ„ë©”í”„+íŒë§¤ì+ì •ì‚°í™•ì¸+ìë£Œ+ì˜ˆì‹œ", "ë‚´+í•œë„+ê´€ë¦¬+ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€",
            "(ê¸°ì—…ë±…í‚¹)ê°œì¸ì •ë³´+ì²˜ë¦¬ë°©ì¹¨", "[ê¸°ì—…ë±…í‚¹ìš©]+í† ìŠ¤ë±…í¬+ì¸ì¦ì„œ+ì„œë¹„ìŠ¤+ì´ìš©ì•½ê´€",
            "[í•„ìˆ˜]ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ[ì „ìê¸ˆìœµê±°ë˜+ì‚¬ê³ +í”¼í•´ì¡°ì‚¬]", "[í•„ìˆ˜]+ë¯¼ê°ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ë¹„ê³¼ì„¸ì¢…í•©ì €ì¶•]+",
            "[ì„ íƒ]+ê°œì¸ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ì´ë²¤íŠ¸+ì•Œë¦¼ë°›ê¸°]", "[ì„ íƒ]+ê°œì¸ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ì´ë²¤íŠ¸+ì°¸ì—¬]",
            "[ì„ íƒ]+ê°œì¸ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ëŒ€ì¶œ+ê°ˆì•„íƒ€ê¸°+ì•Œë¦¼ë°›ê¸°]", "[í•„ìˆ˜]+ê°œì¸ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ+[ë¯¼ì›ì ‘ìˆ˜]",
            "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ì¡°íšŒë™ì˜ì„œ+[ê³µê³µ+ë§ˆì´ë°ì´í„°]+(ì œíœ´íšŒì›ìš©)", "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘ì´ìš©+ë™ì˜ì„œ+(êµ¬ë…+ì„œë¹„ìŠ¤+ì´ìš©)",
            "[ì„ íƒ]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘ì´ìš©+ë™ì˜ì„œ[ì¹´ë“œ+ìºì‹œë°±+í”„ë¡œëª¨ì…˜+ì•Œë¦¼]+", "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘,+ì´ìš©+ë™ì˜ì„œ(ì‹ ê³ ì ‘ìˆ˜)+(ì•ˆì‹¬ë³´ìƒì œ)+(ìˆ˜ê¸°ìš©)",
            "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘,+ì´ìš©,+ì œê³µ+ë™ì˜ì„œ[ì „ìê¸ˆìœµê±°ë˜+ì‚¬ê³ +í”¼í•´ì¡°ì‚¬]+(ì•ˆì‹¬ë³´ìƒì œ)+(ì„œë©´ìš©)",
            "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+(ì˜¤í”ˆë±…í‚¹+ì•ˆì‹¬ì°¨ë‹¨+ì„œë¹„ìŠ¤)", "[ì„ íƒ]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ìˆ˜ì¶œë˜‘ë˜‘ë³´ì¦ëŒ€ì¶œ+ì¶œì‹œ+ì•Œë¦¼+ë°›ê¸°]",
            "[ì„ íƒ]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ì œíœ´ëŒ€í™˜ëŒ€ì¶œ+ì˜¤í”ˆì•ˆë‚´]", "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ê¸°ì—…ë±…í‚¹+íšŒì›ê°€ì…ìš©]",
            "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µ+ë™ì˜ì„œ(ì‚¬ì—…ì¥+ìœ„ì¹˜ì •ë³´)", "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©Â·ì œê³µÂ·ì¡°íšŒ+ë™ì˜ì„œ+(ì œíœ´íšŒì›ìš©)",
            "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘ãƒ»ì´ìš©+ë™ì˜ì„œ+[ëª¨ì„í†µì¥ì„œë¹„ìŠ¤ì´ìš©]+", "ã€Œì˜¤í”ˆë±…í‚¹ê³µë™ì—…ë¬´ã€+ê¸ˆìœµì •ë³´+ì¡°íšŒ+ì•½ê´€+(ê¸°ì—…ê³ ê°ìš©)",
            "í† ìŠ¤ë±…í¬_í•˜ë£¨_1ë¶„_ë‡Œ_ìš´ë™_ì„œë¹„ìŠ¤_ì´ìš©ì•½ê´€", "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘ãƒ»ì´ìš©+ë™ì˜ì„œ+[í•˜ë£¨+1ë¶„+ë‡Œ+ìš´ë™+ì„œë¹„ìŠ¤]",
            "ì¤‘ì†Œê¸°ì—…ì€í–‰ë²• íƒ€ë²•ê°œì • 2020.03.24 [ë²•ë¥  ì œ17112í˜¸, ì‹œí–‰ 2021.3.25.] ê¸ˆìœµìœ„ì›íšŒ",
            "í•œêµ­ì€í–‰ë²• íƒ€ë²•ê°œì • 2023.05.16 [ë²•ë¥  ì œ19409í˜¸, ì‹œí–‰ 2024.5.17.] ê¸°íšì¬ì •ë¶€",
            "ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ(ì œíœ´ëŒ€í™˜ëŒ€ì¶œìš©)+(íŒë§¤ì¢…ë£Œ+-+2023.05.19.)", "ëŒ€ì¶œê±°ë˜+ì¶”ê°€ì•½ì •ì„œ(ì œíœ´ëŒ€í™˜ëŒ€ì¶œìš©)+(íŒë§¤ì¢…ë£Œ+-+2023.05.19.)",
            "ì€í–‰ë²• íƒ€ë²•ê°œì • 2023.09.14 [ë²•ë¥  ì œ19700í˜¸, ì‹œí–‰ 2023.9.14.] ê¸ˆìœµìœ„ì›íšŒ",
            "í† ìŠ¤ë±…í¬++ëª¨ìœ¼ê¸°+ìƒí’ˆì„¤ëª…ì„œ(íŒë§¤ì¢…ë£Œ+-+2024.02.14.)", "í† ìŠ¤ë±…í¬_ëª¨ìœ¼ê¸°_íŠ¹ì•½_(íŒë§¤ì¢…ë£Œ_-_2024.02.14.)",
            "í•œêµ­ìˆ˜ì¶œì…ì€í–‰ë²• ì¼ë¶€ê°œì • 2024.03.19 [ë²•ë¥  ì œ20373í˜¸, ì‹œí–‰ 2024.3.19.] ê¸°íšì¬ì •ë¶€",
            "ìƒí˜¸ì €ì¶•ì€í–‰ë²• íƒ€ë²•ê°œì • 2024.09.20 [ë²•ë¥  ì œ20434í˜¸, ì‹œí–‰ 2025.1.31.] ê¸ˆìœµìœ„ì›íšŒ",
            "í•œêµ­ì‚°ì—…ì€í–‰ë²• ì¼ë¶€ê°œì • 2025.01.21 [ë²•ë¥  ì œ20719í˜¸, ì‹œí–‰ 2025.1.21.] ê¸ˆìœµìœ„ì›íšŒ",
            "í•œêµ­ìˆ˜ì¶œì…ì€í–‰ë²• ì‹œí–‰ë ¹ íƒ€ë²•ê°œì • 2025.01.21 [ëŒ€í†µë ¹ë ¹ ì œ35228í˜¸, ì‹œí–‰ 2025.1.31.] ê¸°íšì¬ì •ë¶€",
            "ì¤‘ì†Œê¸°ì—…ì€í–‰ë²• ì‹œí–‰ë ¹ íƒ€ë²•ê°œì • 2025.01.21 [ëŒ€í†µë ¹ë ¹ ì œ35228í˜¸, ì‹œí–‰ 2025.1.31.] ê¸ˆìœµìœ„ì›íšŒ",
            "í•œêµ­ì€í–‰ë²• ì‹œí–‰ë ¹ íƒ€ë²•ê°œì • 2025.01.21 [ëŒ€í†µë ¹ë ¹ ì œ35228í˜¸, ì‹œí–‰ 2025.1.31.] ê¸°íšì¬ì •ë¶€",
            "ì€í–‰ë²• ì‹œí–‰ë ¹ íƒ€ë²•ê°œì • 2025.03.12 [ëŒ€í†µë ¹ë ¹ ì œ35382í˜¸, ì‹œí–‰ 2025.3.12.] ê¸ˆìœµìœ„ì›íšŒ",
            "í•œêµ­ì‚°ì—…ì€í–‰ë²• ì‹œí–‰ë ¹ ì¼ë¶€ê°œì • 2025.06.25 [ëŒ€í†µë ¹ë ¹ ì œ35607í˜¸, ì‹œí–‰ 2025.6.25.] ê¸ˆìœµìœ„ì›íšŒ",
            "ê°œì¸ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+í•¨ê»˜+ì‘ì›í•˜ê¸°+ì„œë¹„ìŠ¤]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ë°+ê¸ˆìœµê±°ë˜ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[ëª¨ì„í†µì¥ì„œë¹„ìŠ¤ì´ìš©]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[ì´ìƒê¸ˆìœµê±°ë˜í–‰ìœ„+íƒì§€+ë“±]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[ë¹„ë°”ë¦¬í¼ë¸”ë¦¬ì¹´]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ[ì •ë³´+ìë™ì…ë ¥]", "[í•„ìˆ˜]+í† ìŠ¤ê³„ì •í†µí•©ì„œë¹„ìŠ¤+ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ[ë¹„ë°”ë¦¬í¼ë¸”ë¦¬ì¹´]",
            "[í•„ìˆ˜]+ê°œì¸ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜+(ì•ˆì‹¬ë³´ìƒ+ì‹ ê³ ì ‘ìˆ˜)", "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ë°+ê¸ˆìœµê±°ë˜ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[ëª¨ì„ì¹´ë“œì„œë¹„ìŠ¤ì´ìš©]",
            "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ë°+ê¸ˆìœµê±°ë˜ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[í•¨ê»˜+í‚¤ìš°ê¸°]+", "[ì„ íƒ]+ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+(ìë…€+ê³„ì¢Œ+ê´€ë¦¬+ì„œë¹„ìŠ¤)",
            "[ì„ íƒ]+ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+ì´ë²¤íŠ¸+ì°¸ì—¬]_ì¶”ê°€ì •ë³´", "[í•„ìˆ˜]+ê°œì¸(ì‹ ìš©)ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[ìë™ì°¨+ì‹œì„¸+ì •ë³´+ì¡°íšŒ]",
            "ê°œì¸ì •ë³´+ì œ3ì+ì œê³µ+ë™ì˜ì„œ+[í† ìŠ¤ë±…í¬+í•˜ë£¨+1ë¶„+ë‡Œ+ìš´ë™+ì„œë¹„ìŠ¤]", "í† ìŠ¤ë±…í¬+ì²´í¬ì¹´ë“œ+ìŠ¤ìœ„ì¹˜+ìºì‹œë°±+ì‹œì¦Œ5+_+ì–´ë””ì„œë‚˜+ìºì‹œë°±",
            "í† ìŠ¤ë±…í¬+ì²´í¬ì¹´ë“œ+ìŠ¤ìœ„ì¹˜+ìºì‹œë°±+ì‹œì¦Œ5+_+ì˜¤í”„ë¼ì¸+ìºì‹œë°±", "í† ìŠ¤ë±…í¬+ì²´í¬ì¹´ë“œ+ìŠ¤ìœ„ì¹˜+ìºì‹œë°±+ì‹œì¦Œ5+_+ì˜¨ë¼ì¸+ìºì‹œë°±",
            "í† ìŠ¤ë±…í¬+ì²´í¬ì¹´ë“œ+ìŠ¤ìœ„ì¹˜+ìºì‹œë°±+ì‹œì¦Œ5+_+ê¸°ë¶€+ìºì‹œë°± (1)", "CDìˆ˜ìµë¥ +ì„¤ëª…ì„œ",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘Â·ì´ìš©+ë™ì˜ì„œ+[ChatGPT+$1ì—+êµ¬ë…í•˜ê¸°+ì´ë²¤íŠ¸]", "ê°œì¸(ì‹ ìš©)ì •ë³´+ì¡°íšŒ+ë™ì˜ì„œ++[ê³µê³µ+ë§ˆì´ë°ì´í„°_ë‚˜ì˜+DSR]",
            "ê°œì¸(ì‹ ìš©)ì •ë³´+ìˆ˜ì§‘ãƒ»ì´ìš©Â·ì œê³µÂ·ì¡°íšŒ+ë™ì˜ì„œ+[ë‚˜ì˜+DSR]", "ë‚˜ì˜+í–‰ì •ì •ë³´+í† ìŠ¤ë±…í¬+ì œê³µ+ìš”ì²­ì„œ[ê³µê³µë§ˆì´ë°ì´í„°_ë‚˜ì˜DSR]",
            "ë³¸ì¸í™•ì¸ì„œ+(FATCA+Â·+CRS+ë¶€ëª¨_ëŒ€ë¦¬ì¸ìš©)", "ë³¸ì¸+í™•ì¸ì„œ+(FATCA+Â·+CRS+ê°œì¸ìš©)",
            "ë³¸ì¸+í™•ì¸ì„œ+(FATCA+Â·+CRS+ë²•ì¸ìš©)", "KCB+ì˜¬í¬ë ˆë”§+ì„œë¹„ìŠ¤+ì´ìš©ì•½ê´€+(ì‹ ìƒì •ë³´ì„œë¹„ìŠ¤)",
            "KCB+ëª¨ë°”ì¼+ì•ˆì‹¬+í”ŒëŸ¬ìŠ¤+ì´ìš©ì•½ê´€", "ê°œì¸ì‹ ìš©ë³´í—˜+ì¶”ê°€ì•½ì •ì„œ(SGI)", "ê¸°íšŒUPë³´ì¦ëŒ€ì¶œ+ìƒí’ˆì•ˆë‚´"
        ]
    
    async def process_query(self, question: str) -> Dict:
        """ë©”ì¸ ì¿¼ë¦¬ ì²˜ë¦¬"""
        try:
            print(f"RAG ê²€ìƒ‰ ì‹œì‘: '{question}'")
            
            # 1. ì¸ì‚¬ë§ ì²´í¬
            if self.is_greeting(question):
                return {
                    "answer": "ì•ˆë…•í•˜ì„¸ìš”! AI í•˜ë¦¬ë³´ì…ë‹ˆë‹¤ ğŸ» ì‹ ì…ì‚¬ì› ì˜¨ë³´ë”© ê´€ë ¨ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ì£¼ì„¸ìš”!",
                    "sources": [],
                    "response_time": 0.0,
                    "answer_type": "greeting",
                    "mode": "GREETING",
                    "doc_type": "general",
                    "citations": [],
                    "next_actions": [],
                    "confidence": 1.0,
                    "notes": "ì¸ì‚¬ë§ ì‘ë‹µ"
                }
            
            # 2. ì œëª© ë§¤ì¹­ í™•ì¸
            matched_titles = self.find_exact_title_match(question)
            print(f"ë§¤ì¹­ëœ ì œëª©ë“¤: {matched_titles}")
            
            # 3. RAG ë¬¸ì„œ ê²€ìƒ‰
            rag_docs = await self.search_rag_documents(question)
            print(f"RAG ë¬¸ì„œ ê²€ìƒ‰ ê²°ê³¼: {len(rag_docs)}ê°œ")
            
            # 4. ë‹µë³€ ìƒì„±
            if rag_docs or matched_titles:
                # RAG ë‹µë³€ ìƒì„±
                answer = await self.generate_rag_answer(question, rag_docs, matched_titles)
                
                # sourcesë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë³€í™˜ (RAG ë¬¸ì„œì™€ ë§¤ì¹­ëœ ì œëª© ëª¨ë‘ í¬í•¨)
                sources = []
                
                # 1. RAG ë¬¸ì„œì—ì„œ ì°¾ì€ ì œëª©ë“¤ ì¶”ê°€
                if rag_docs:
                    for doc in rag_docs[:3]:
                        sources.append({"title": doc.get("title", ""), "type": "document"})
                
                # 2. ë§¤ì¹­ëœ ì œëª©ë“¤ ì¶”ê°€ (ì¤‘ë³µ ì œê±°)
                if matched_titles:
                    existing_titles = {source["title"] for source in sources}
                    for title in matched_titles[:3]:
                        if title not in existing_titles:
                            sources.append({"title": title, "type": "document"})
                
                print(f"ìµœì¢… sources: {sources}")
                
                return {
                    "answer": answer,
                    "sources": sources,  # ê´€ë ¨ ìë£Œì‹¤ ë¬¸ì„œ í‘œì‹œ ë³µì›
                    "response_time": 0.0,
                    "answer_type": "rag",
                    "mode": "RAG",
                    "doc_type": "form",
                    "citations": [],
                    "next_actions": [],
                    "confidence": 0.9,
                    "notes": "RAG ë‹µë³€"
                }
            else:
                # ì€í–‰ ì—…ë¬´ ê´€ë ¨ ì§ˆë¬¸ì¸ì§€ í™•ì¸ (í‚¤ì›Œë“œ í™•ì¥)
                bank_keywords = ["ê³ ê°", "ëŒ€ì¶œ", "ì˜ˆê¸ˆ", "ì ê¸ˆ", "ìƒí’ˆ", "ê¸ˆë¦¬", "í•œë„", "ì‹ ì²­", "ì„œë¥˜", "ì ˆì°¨", "ì¶”ì²œ", "ë¬¸ì˜", "ìƒë‹´", 
                               "ë³´ì´ìŠ¤í”¼ì‹±", "í”¼ì‹±", "ì‚¬ê¸°", "í”¼í•´", "ëŒ€ì²˜", "ì‹ ê³ ", "ì˜ˆë°©", "ê¸ˆìœµì‚¬ê³ ", "ë³´ì•ˆ", "ì•ˆì „",
                               "ì…ì¶œê¸ˆ", "ì´ì", "ìˆ˜ìˆ˜ë£Œ", "ë©´ì œ", "ê³„ì‚°", "ì¤‘ë„í•´ì§€", "ì•½ê´€", "ê¸°ë³¸ì•½ê´€", "íŠ¹ì•½", "ìƒí’ˆì„¤ëª…ì„œ",
                               "ëª¨ì„í†µì¥", "í†µì¥", "ê³„ì¢Œ", "ê°œì¸ì •ë³´", "ì œ3ì", "ì œê³µ", "ë²”ìœ„", "ì„œë¹„ìŠ¤", "ì´ìš©ì•½ê´€", "ê±°ë˜ì•½ê´€",
                               "ìƒí’ˆì¶”ì²œ", "ì¶”ì²œìƒí’ˆ", "ìƒí’ˆì•ˆë‚´", "ìƒí’ˆì†Œê°œ", "ìƒí’ˆë¹„êµ", "ìƒí’ˆì„ íƒ", "ìƒí’ˆê°€ì…", "ìƒí’ˆê°€ì…ì ˆì°¨"]
                if any(keyword in question for keyword in bank_keywords):
                    # ì€í–‰ ì—…ë¬´ ê´€ë ¨ ì§ˆë¬¸ì€ RAG + GPT í˜‘ì—… ì‚¬ìš©
                    answer = await self.generate_rag_gpt_collaboration(question, rag_docs, matched_titles)
                    
                    # sources êµ¬ì„±
                    sources = []
                    if rag_docs:
                        for doc in rag_docs[:3]:
                            sources.append({"title": doc.get("title", ""), "type": "document"})
                    if matched_titles:
                        existing_titles = {source["title"] for source in sources}
                        for title in matched_titles[:3]:
                            if title not in existing_titles:
                                sources.append({"title": title, "type": "document"})
                    
                    return {
                        "answer": answer,
                        "sources": sources,
                        "response_time": 0.0,
                        "answer_type": "rag_gpt_collaboration",
                        "mode": "BANK_ADVICE",
                        "doc_type": "general",
                        "citations": [],
                        "next_actions": [],
                        "confidence": 0.8,
                        "notes": "RAG + GPT í˜‘ì—… ë‹µë³€"
                    }
                else:
                    # ì™„ì „íˆ ê´€ë ¨ ì—†ëŠ” ì§ˆë¬¸ì— ëŒ€í•œ ì•ˆë‚´
                    answer = await self.generate_off_topic_answer(question)
                    return {
                        "answer": answer,
                        "sources": [],
                        "response_time": 0.0,
                        "answer_type": "off_topic",
                        "mode": "OFF_TOPIC",
                        "doc_type": "general",
                        "citations": [],
                        "next_actions": [],
                        "confidence": 0.8,
                        "notes": "ê´€ë ¨ ì—†ëŠ” ì§ˆë¬¸ ì•ˆë‚´"
                    }
                
        except Exception as e:
            print(f"Process query error: {e}")
            return {
                "answer": "ì£„ì†¡í•©ë‹ˆë‹¤. ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
                "sources": [],
                "response_time": 0.0,
                "answer_type": "error",
                "mode": "ERROR",
                "doc_type": "general",
                "citations": [],
                "next_actions": [],
                "confidence": 0.0,
                "notes": f"ì˜¤ë¥˜: {str(e)}"
            }
    
    def find_matching_titles(self, query: str) -> List[str]:
        """ì œëª© ë§¤ì¹­ (íŠ¹ìˆ˜ë¬¸ì ì²˜ë¦¬ í¬í•¨)"""
        query_clean = self.clean_text(query)
        matched = []
        
        for title in self.document_titles:
            title_clean = self.clean_text(title)
            
            # ì •í™•í•œ ë§¤ì¹­
            if query_clean in title_clean or title_clean in query_clean:
                matched.append(title)
                continue
            
            # ë¶€ë¶„ ë§¤ì¹­ (ë‹¨ì–´ ë‹¨ìœ„)
            query_words = query_clean.split()
            title_words = title_clean.split()
            
            for q_word in query_words:
                for t_word in title_words:
                    if q_word in t_word or t_word in q_word:
                        if title not in matched:
                            matched.append(title)
                        break
        
        return matched[:5]  # ìµœëŒ€ 5ê°œ
    
    def clean_text(self, text: str) -> str:
        """í…ìŠ¤íŠ¸ ì •ë¦¬ (íŠ¹ìˆ˜ë¬¸ì ì œê±°)"""
        import re
        # íŠ¹ìˆ˜ë¬¸ìë¥¼ ê³µë°±ìœ¼ë¡œ ë³€í™˜
        text = re.sub(r'[+()\[\]{}&=\-_Â·]', ' ', text)
        # ì—°ì†ëœ ê³µë°±ì„ í•˜ë‚˜ë¡œ
        text = re.sub(r'\s+', ' ', text)
        return text.lower().strip()
    
    def find_exact_title_match(self, query: str) -> List[str]:
        """ì •í™•í•œ ì œëª© ë§¤ì¹­ (íŠ¹ìˆ˜ë¬¸ì ì²˜ë¦¬ ê°œì„ )"""
        query_clean = self.clean_text(query)
        matched = []
        
        for title in self.document_titles:
            title_clean = self.clean_text(title)
            
            # ì •í™•í•œ ë§¤ì¹­
            if query_clean == title_clean:
                matched.append(title)
                continue
            
            # ë¶€ë¶„ ë§¤ì¹­ (ë‹¨ì–´ ë‹¨ìœ„)
            query_words = query_clean.split()
            title_words = title_clean.split()
            
            # ëª¨ë“  ì¿¼ë¦¬ ë‹¨ì–´ê°€ ì œëª©ì— í¬í•¨ë˜ëŠ”ì§€ í™•ì¸
            if all(any(q_word in t_word or t_word in q_word for t_word in title_words) for q_word in query_words):
                matched.append(title)
        
        return matched[:5]
    
    async def search_rag_documents(self, query: str) -> List[Dict]:
        """RAG ë¬¸ì„œ ê²€ìƒ‰ (ì¿¼ë¦¬ í™•ì¥ í¬í•¨)"""
        try:
            # ì›ë³¸ ì¿¼ë¦¬ì™€ ì •ë¦¬ëœ ì¿¼ë¦¬ ëª¨ë‘ ì‚¬ìš©
            query_original = query.strip()
            query_clean = self.clean_text(query)
            
            # ì¿¼ë¦¬ í™•ì¥ (í‚¤ì›Œë“œ ê¸°ë°˜)
            expanded_queries = self.expand_query(query_original)
            
            print(f"ê²€ìƒ‰ ì¿¼ë¦¬: '{query_original}' -> ì •ë¦¬ëœ ì¿¼ë¦¬: '{query_clean}'")
            print(f"í™•ì¥ëœ ì¿¼ë¦¬ë“¤: {expanded_queries}")
            
            # SQLì—ì„œ ì§ì ‘ í…ìŠ¤íŠ¸ ë§¤ì¹­ ì‚¬ìš© (í™•ì¥ëœ ì¿¼ë¦¬ í¬í•¨)
            all_queries = [query_original, query_clean] + expanded_queries
            
            # ë™ì  SQL ìƒì„±
            query_conditions = []
            params = {}
            for i, q in enumerate(all_queries):
                if q.strip():  # ë¹ˆ ì¿¼ë¦¬ ì œì™¸
                    query_conditions.append(f"(dc.content ILIKE :query{i} OR d.title ILIKE :query{i})")
                    params[f"query{i}"] = f"%{q}%"
            
            if not query_conditions:
                return []
            
            sql = text(f"""
                SELECT 
                    dc.content,
                    d.title,
                    d.category,
                    d.id as document_id
                FROM document_chunks dc
                JOIN documents d ON dc.document_id = d.id
                WHERE d.is_indexed = true 
                AND d.category = 'RAG'
                AND ({' OR '.join(query_conditions)})
                LIMIT 20
            """)
            
            result = self.session.execute(sql, params)
            
            docs = []
            for row in result:
                docs.append({
                    "content": row.content,
                    "title": row.title,
                    "category": row.category,
                    "document_id": row.document_id
                })
                print(f"SQL ë§¤ì¹­: '{row.title}'")
            
            print(f"SQL í…ìŠ¤íŠ¸ ë§¤ì¹­ìœ¼ë¡œ {len(docs)}ê°œ ë¬¸ì„œ ë°œê²¬")
            return docs
            
        except Exception as e:
            print(f"RAG ë¬¸ì„œ ê²€ìƒ‰ ì˜¤ë¥˜: {e}")
            return []
    
    def expand_query(self, query: str) -> List[str]:
        """ì¿¼ë¦¬ í™•ì¥ (í‚¤ì›Œë“œ ê¸°ë°˜)"""
        expanded = []
        
        # ì˜ˆê¸ˆ ê´€ë ¨ í™•ì¥
        if "ì…ì¶œê¸ˆ" in query or "ì˜ˆê¸ˆ" in query:
            expanded.extend(["ì…ì¶œê¸ˆì´ììœ ë¡œìš´ì˜ˆê¸ˆ", "ì…ì¶œê¸ˆì´ììœ ë¡œìš´ì˜ˆê¸ˆ_ì•½ê´€", "ì˜ˆê¸ˆê±°ë˜ê¸°ë³¸ì•½ê´€"])
        
        if "ì´ì" in query:
            expanded.extend(["ì´ìê³„ì‚°", "ì´ìê³„ì‚°ë‚´ì—­ì„œ", "ì´ì"])
        
        if "ìˆ˜ìˆ˜ë£Œ" in query:
            expanded.extend(["ìˆ˜ìˆ˜ë£Œ", "ë©´ì œ", "ìˆ˜ìˆ˜ë£Œë©´ì œ"])
        
        if "ì ê¸ˆ" in query:
            expanded.extend(["ì ë¦½ì‹ì˜ˆê¸ˆì•½ê´€", "ì ê¸ˆ", "ì ë¦½ì‹"])
        
        if "ì¤‘ë„í•´ì§€" in query:
            expanded.extend(["ì¤‘ë„í•´ì§€", "í•´ì§€", "ë§Œê¸°ì „í•´ì§€"])
        
        if "ì•½ê´€" in query:
            expanded.extend(["ì•½ê´€", "ê¸°ë³¸ì•½ê´€", "ê±°ë˜ì•½ê´€"])
        
        # ì‹ ìš©ë³´ì¦ ê´€ë ¨ í™•ì¥
        if "ì‹ ìš©ë³´ì¦" in query:
            expanded.extend(["ì‹ ìš©ë³´ì¦ì„œ", "ì‹ ìš©ë³´ì¦ì•½ì •ì„œ", "ì‹ ìš©ë³´ì¦ì‹ ì²­ì„œ", "ì‹ ìš©ë³´ì¦ë¶€ì‹¤í†µì§€ì„œ"])
        
        if "ë³´ì¦ë£Œ" in query or "ë³´ì¦ë£Œìœ¨" in query:
            expanded.extend(["ë³´ì¦ë£Œ", "ë³´ì¦ë£Œìœ¨", "ì‹ ìš©ë³´ì¦ì•½ì •ì„œ"])
        
        if "ì±„ë¬´ì´í–‰" in query:
            expanded.extend(["ì±„ë¬´ì´í–‰", "ë³´ì¦ì±„ë¬´ì´í–‰ì²­êµ¬ì„œ", "ì±„ë¬´ì´í–‰ì ˆì°¨"])
        
        if "ëŒ€ì¶œ" in query:
            expanded.extend(["ëŒ€ì¶œ", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ", "ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œë§Œê¸°ì•ˆë‚´"])
        
        # ëª¨ì„í†µì¥/ê³„ì¢Œ ê´€ë ¨ í™•ì¥
        if "ëª¨ì„í†µì¥" in query or "í†µì¥" in query:
            expanded.extend(["ëª¨ì„í†µì¥", "í†µì¥", "ê³„ì¢Œ", "ê³„ì¢Œí†µí•©ê´€ë¦¬ì„œë¹„ìŠ¤", "ê³„ì¢Œì´ë™ì„œë¹„ìŠ¤"])
        
        if "ê°œì¸ì •ë³´" in query:
            expanded.extend(["ê°œì¸ì •ë³´", "ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨", "ê°œì¸ì •ë³´+ì²˜ë¦¬ë°©ì¹¨"])
        
        if "ì œ3ì" in query or "ì œê³µ" in query:
            expanded.extend(["ì œ3ì", "ì œê³µ", "ë™ì˜ì„œ", "ê¸ˆìœµê±°ë˜ì •ë³´+ì œê³µ+ë™ì˜ì„œ"])
        
        # ìƒí’ˆ ê´€ë ¨ í™•ì¥
        if "ìƒí’ˆ" in query or "ì¶”ì²œ" in query:
            expanded.extend(["ìƒí’ˆì„¤ëª…ì„œ", "ìƒí’ˆì•ˆë‚´", "ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ê¸°ì—…ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ìƒí’ˆì†Œê°œ"])
        
        if "ëŒ€ì¶œìƒí’ˆ" in query or "ëŒ€ì¶œ" in query:
            expanded.extend(["ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ê¸°ì—…ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œìƒí’ˆì•ˆë‚´", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ"])
        
        if "ì˜ˆê¸ˆìƒí’ˆ" in query or "ì˜ˆê¸ˆ" in query:
            expanded.extend(["ì˜ˆê¸ˆìƒí’ˆì„¤ëª…ì„œ", "ì˜ˆê¸ˆìƒí’ˆì•ˆë‚´", "ì…ì¶œê¸ˆì´ììœ ë¡œìš´ì˜ˆê¸ˆ", "ì ë¦½ì‹ì˜ˆê¸ˆì•½ê´€"])
        
        # ì—°ë ¹ëŒ€ë³„ ëŒ€ì¶œ ìƒí’ˆ í™•ì¥
        if "70ëŒ€" in query or "ê³ ë ¹" in query or "ì—°ë ¹" in query:
            expanded.extend(["ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ", "ìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œìƒí’ˆì•ˆë‚´"])
        
        # ëŒ€ì¶œ ìƒë‹´ ê´€ë ¨ í™•ì¥
        if "ëŒ€ì¶œìƒë‹´" in query or "ëŒ€ì¶œ ì¶”ì²œ" in query or "ëŒ€ì¶œ ìƒí’ˆ" in query:
            expanded.extend(["ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ", "ëŒ€ì¶œìƒí’ˆì•ˆë‚´", "ìƒí’ˆì„¤ëª…ì„œ", "ì£¼íƒë‹´ë³´ëŒ€ì¶œ", "ê°€ê³„ëŒ€ì¶œ", "ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ"])
        
        # êµ¬ì²´ì ì¸ ëŒ€ì¶œ ìƒí’ˆëª… í™•ì¥
        if "ëŒ€ì¶œ" in query:
            expanded.extend(["ê°€ê³„ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ëŒ€ì¶œìƒí’ˆì„¤ëª…ì„œ", "ì£¼íƒë‹´ë³´ëŒ€ì¶œ", "ê°€ê³„ëŒ€ì¶œ", "ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ", "ëŒ€ì¶œê±°ë˜ì•½ì •ì„œ"])
        
        # ì¤‘ë³µ ì œê±° ë° ë¹ˆ ë¬¸ìì—´ ì œê±°
        expanded = list(set([q for q in expanded if q.strip()]))
        
        return expanded
    
    async def generate_rag_answer(self, question: str, rag_docs: List[Dict], matched_titles: List[str]) -> str:
        """RAG ë‹µë³€ ìƒì„±"""
        # RAG ë‚´ìš© êµ¬ì„±
        rag_content = ""
        if rag_docs:
            rag_content = "\n\n".join([doc["content"][:300] for doc in rag_docs[:3]])
        
        # ì°¸ê³ ìë£Œ êµ¬ì„±
        references = ""
        if matched_titles:
            references = f"\n\nğŸ“š ê´€ë ¨ ìë£Œì‹¤ ë¬¸ì„œ:\n"
            for i, title in enumerate(matched_titles[:3], 1):
                references += f"{i}. {title}\n"
        
        prompt = f"""
ë‹¤ìŒ ë¬¸ì„œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”.

ë¬¸ì„œ ë‚´ìš©:
{rag_content}

ì§ˆë¬¸: {question}

ë‹µë³€ ìš”êµ¬ì‚¬í•­:
1. ì‹ ì…ì‚¬ì›ì´ ì´í•´í•˜ê¸° ì‰½ê²Œ ê°„ê²°í•˜ê³  ì¹œì ˆí•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”
2. ê¸´ ë¬¸ë‹¨ ëŒ€ì‹  ì§§ì€ ë¬¸ì¥ê³¼ ë¶ˆë¦¿ í¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
3. í•µì‹¬ ì •ë³´ë¥¼ ë¨¼ì € ì œì‹œí•˜ê³ , ì„¸ë¶€ì‚¬í•­ì€ ë‚˜ì¤‘ì— ì„¤ëª…í•˜ì„¸ìš”
4. ë‹¨ê³„ë³„ë¡œ ë‚˜ëˆ„ì–´ ì„¤ëª…í•˜ì„¸ìš” (1ë‹¨ê³„, 2ë‹¨ê³„ ë“±)
5. í•œêµ­ì–´ë¡œ ì¹œê·¼í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš” (ğŸ» ì´ëª¨í‹°ì½˜ë§Œ ì‚¬ìš©)
6. AI í•˜ë¦¬ë³´ë¡œì„œ ì‹ ì…ì‚¬ì›ì„ ë„ì™€ì£¼ëŠ” ë§ˆìŒìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”

ë‹µë³€:
"""
        
        answer = await self.call_gpt(prompt)
        
        # ì°¸ê³ ìë£Œ ì¶”ê°€
        if references:
            answer += references
        
        return answer
    
    def is_greeting(self, query: str) -> bool:
        """ì¸ì‚¬ë§ ê°ì§€"""
        greetings = ["ì•ˆë…•", "ì•ˆë…•í•˜ì„¸ìš”", "hi", "hello", "ã…ã…‡", "í•˜ì´", "í—¬ë¡œ", "ì¢‹ì€ ì•„ì¹¨", "ì¢‹ì€ ì˜¤í›„", "ì¢‹ì€ ì €ë…", "ì•ˆã„´ë…•"]
        return any(greeting in query.lower() for greeting in greetings)
    
    async def generate_off_topic_answer(self, question: str) -> str:
        """ê´€ë ¨ ì—†ëŠ” ì§ˆë¬¸ì— ëŒ€í•œ ì•ˆë‚´"""
        # ì€í–‰ ì—…ë¬´ ê´€ë ¨ ì§ˆë¬¸ì¸ì§€ í™•ì¸
        bank_keywords = ["ê³ ê°", "ëŒ€ì¶œ", "ì˜ˆê¸ˆ", "ì ê¸ˆ", "ìƒí’ˆ", "ê¸ˆë¦¬", "í•œë„", "ì‹ ì²­", "ì„œë¥˜", "ì ˆì°¨", "ì¶”ì²œ", "ë¬¸ì˜", "ìƒë‹´"]
        if any(keyword in question for keyword in bank_keywords):
            return "ì€í–‰ ì—…ë¬´ ê´€ë ¨ ì§ˆë¬¸ì´ì‹œêµ°ìš”! ğŸ» ì‹ ì…ì‚¬ì› ì˜¨ë³´ë”© ìë£Œì‹¤ì˜ ìƒí’ˆì„¤ëª…ì„œë‚˜ ì•½ê´€ ë¬¸ì„œë¥¼ ì°¸ê³ í•´ì„œ ë‹µë³€ë“œë¦´ ìˆ˜ ìˆì–´ìš”. êµ¬ì²´ì ì¸ ìƒí’ˆëª…ì´ë‚˜ ì„œë¥˜ëª…ì„ ë§ì”€í•´ì£¼ì‹œë©´ ë” ì •í™•í•œ ì•ˆë‚´ë¥¼ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"
        
        return "ì£„ì†¡í•´ìš” ğŸ» AI í•˜ë¦¬ë³´ëŠ” ì‹ ì…ì‚¬ì› ì˜¨ë³´ë”© ê´€ë ¨ ì§ˆë¬¸ì„ ì£¼ë¡œ ë„ì™€ë“œë ¤ìš”. ìœ„ì„ì¥, ì´ì˜ì‹ ì²­ì„œ, ì•½ê´€, ìƒí’ˆì„¤ëª…ì„œ ë“±ì— ëŒ€í•´ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ì£¼ì„¸ìš”!"
    
    async def generate_rag_gpt_collaboration(self, question: str, rag_docs: List[Dict], matched_titles: List[str]) -> str:
        """RAG + GPT í˜‘ì—… ë‹µë³€"""
        # RAG ë‚´ìš© êµ¬ì„±
        rag_content = ""
        if rag_docs:
            for i, doc in enumerate(rag_docs[:3], 1):
                rag_content += f"\n[ë¬¸ì„œ {i}] {doc.get('title', '')}\n{doc.get('content', '')}\n"
        
        # ì°¸ê³ ìë£Œ ì¶”ê°€
        references = ""
        if matched_titles:
            references = f"\n\nğŸ“š ê´€ë ¨ ìë£Œì‹¤ ë¬¸ì„œ:\n"
            for i, title in enumerate(matched_titles[:3], 1):
                references += f"{i}. {title}\n"
        
        prompt = f"""
ë‹¤ìŒ ë¬¸ì„œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”. ë¬¸ì„œ ë‚´ìš©ì´ ìˆìœ¼ë©´ ë°˜ë“œì‹œ ë¬¸ì„œ ë‚´ìš©ì„ ìš°ì„ ì ìœ¼ë¡œ í™œìš©í•˜ì„¸ìš”.

ë¬¸ì„œ ë‚´ìš©:
{rag_content}

ì§ˆë¬¸: {question}

ë‹µë³€ ìš”êµ¬ì‚¬í•­:
- ì‹ ì…ì‚¬ì›ì´ ì´í•´í•˜ê¸° ì‰½ê²Œ ì¹œì ˆí•˜ê³  ìƒì„¸í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”
- ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ê¸¸ê²Œ ì„¤ëª…í•˜ì„¸ìš” (ë¶ˆë¦¿ í¬ì¸íŠ¸ë‚˜ ë‹¨ê³„ë³„ ë‚˜ì—´ ê¸ˆì§€)
- í•µì‹¬ ì •ë³´ë¥¼ ë¨¼ì € ì œì‹œí•˜ê³ , ì„¸ë¶€ì‚¬í•­ì„ í¬í•¨í•œ ì™„ì „í•œ ì„¤ëª…ì„ ì œê³µí•˜ì„¸ìš”
- ë¬¸ë‹¨ê³¼ ë¬¸ë‹¨ ì‚¬ì´ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°í•˜ì—¬ íë¦„ ìˆê²Œ ì‘ì„±í•˜ì„¸ìš”
- í•œêµ­ì–´ë¡œ ì¹œê·¼í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš” (ğŸ» ì´ëª¨í‹°ì½˜ì€ ë‹µë³€ ì‹œì‘ê³¼ ëì—ë§Œ ì‚¬ìš©)
- AI í•˜ë¦¬ë³´ë¡œì„œ ì‹ ì…ì‚¬ì›ì„ ë„ì™€ì£¼ëŠ” ë§ˆìŒìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”
- ë¬¸ì„œ ë‚´ìš©ì´ ìˆìœ¼ë©´ ë°˜ë“œì‹œ ë¬¸ì„œ ë‚´ìš©ì„ ìš°ì„  í™œìš©í•˜ê³ , ë¬¸ì„œ ë‚´ìš©ì— ì—†ëŠ” ë¶€ë¶„ë§Œ ì¼ë°˜ì ì¸ ì€í–‰ ì—…ë¬´ ì§€ì‹ìœ¼ë¡œ ë³´ì™„í•˜ì„¸ìš”
- ì§ˆë¬¸ê³¼ ê´€ë ¨ ì—†ëŠ” ë‚´ìš©ì€ ë‹µë³€ì— í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”
- ì§ˆë¬¸ì˜ í•µì‹¬ í‚¤ì›Œë“œì™€ ì§ì ‘ ê´€ë ¨ëœ ë‚´ìš©ë§Œ ë‹µë³€í•˜ì„¸ìš”
- ë¬¸ì¥ì„ ì¶©ë¶„íˆ ê¸¸ê²Œ ì‘ì„±í•˜ì—¬ ìƒì„¸í•œ ì„¤ëª…ì„ ì œê³µí•˜ì„¸ìš”
- ê° ë¬¸ë‹¨ì€ 5-7ë¬¸ì¥ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ì¶©ë¶„í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”
- ìƒí’ˆ ì¶”ì²œ ê´€ë ¨ ì§ˆë¬¸ì—ëŠ” êµ¬ì²´ì ì¸ ìƒí’ˆëª…ê³¼ íŠ¹ì§•ì„ í¬í•¨í•˜ì—¬ ë‹µë³€í•˜ì„¸ìš”
- ì—°ë ¹ëŒ€ë³„ ê³ ê° íŠ¹ì„±ì„ ê³ ë ¤í•œ ë§ì¶¤í˜• ìƒí’ˆ ì¶”ì²œì„ ì œê³µí•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒí’ˆì˜ ê²½ìš° ê¸ˆë¦¬, í•œë„, ìƒí™˜ì¡°ê±´ ë“± êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ í¬í•¨í•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒë‹´ ì§ˆë¬¸ì—ëŠ” ì‹¤ì œ ëŒ€ì¶œ ìƒí’ˆì„ ì¶”ì²œí•˜ê³ , ì•Œë¦¼ ì„œë¹„ìŠ¤ë‚˜ ê¸°íƒ€ ì„œë¹„ìŠ¤ëŠ” ì¶”ì²œí•˜ì§€ ë§ˆì„¸ìš”
- ë‹µë³€ì„ ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ê¸¸ê³  ìƒì„¸í•˜ê²Œ ì‘ì„±í•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒí’ˆ ì¶”ì²œ ì‹œì—ëŠ” êµ¬ì²´ì ì¸ ìƒí’ˆëª…(ê°€ê³„ëŒ€ì¶œ, ì£¼íƒë‹´ë³´ëŒ€ì¶œ, ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ ë“±)ì„ ëª…ì‹œí•˜ì„¸ìš”
- 70ëŒ€ ê³ ê°ì—ê²ŒëŠ” ì—°ë ¹ëŒ€ì— ë§ëŠ” ëŒ€ì¶œ ìƒí’ˆì„ êµ¬ì²´ì ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒë‹´ ì§ˆë¬¸ì—ëŠ” ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ëŒ€ì¶œ ìƒí’ˆëª…ì„ ì¶”ì²œí•˜ê³ , ë‹¨ê³„ë³„ ì„¤ëª…ì´ë‚˜ ì¼ë°˜ì ì¸ ì¡°ì–¸ì€ í”¼í•˜ì„¸ìš”
- ê³ ê°ì—ê²Œ ì§ì ‘ì ì¸ ëŒ€ì¶œ ìƒí’ˆ ì¶”ì²œì„ ì œê³µí•˜ì„¸ìš”

ë‹µë³€:
"""
        
        answer = await self.call_gpt(prompt)
        
        # ì°¸ê³ ìë£Œ ì¶”ê°€
        if references:
            answer += references
        
        return answer

    async def generate_gpt_answer(self, question: str) -> str:
        """GPT ë°±ì—… ë‹µë³€"""
        prompt = f"""
ì‹ ì…ì‚¬ì›ì´ ê³ ê° ìƒë‹´ ì‹œ ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡ ë‹µë³€í•´ì£¼ì„¸ìš”.

ì§ˆë¬¸: {question}

ë‹µë³€ ìš”êµ¬ì‚¬í•­:
- ì‹ ì…ì‚¬ì›ì´ ì´í•´í•˜ê¸° ì‰½ê²Œ ì¹œì ˆí•˜ê³  ìƒì„¸í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš”
- ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ê¸¸ê²Œ ì„¤ëª…í•˜ì„¸ìš” (ë¶ˆë¦¿ í¬ì¸íŠ¸ë‚˜ ë‹¨ê³„ë³„ ë‚˜ì—´ ê¸ˆì§€)
- í•µì‹¬ ì •ë³´ë¥¼ ë¨¼ì € ì œì‹œí•˜ê³ , ì„¸ë¶€ì‚¬í•­ì„ í¬í•¨í•œ ì™„ì „í•œ ì„¤ëª…ì„ ì œê³µí•˜ì„¸ìš”
- ë¬¸ë‹¨ê³¼ ë¬¸ë‹¨ ì‚¬ì´ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°í•˜ì—¬ íë¦„ ìˆê²Œ ì‘ì„±í•˜ì„¸ìš”
- í•œêµ­ì–´ë¡œ ì¹œê·¼í•˜ê²Œ ë‹µë³€í•˜ì„¸ìš” (ğŸ» ì´ëª¨í‹°ì½˜ì€ ë‹µë³€ ì‹œì‘ê³¼ ëì—ë§Œ ì‚¬ìš©)
- AI í•˜ë¦¬ë³´ë¡œì„œ ì‹ ì…ì‚¬ì›ì„ ë„ì™€ì£¼ëŠ” ë§ˆìŒìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”
- ì€í–‰ ì—…ë¬´ì— ê´€ë ¨ëœ ì‹¤ìš©ì ì¸ ì¡°ì–¸ì„ í¬í•¨í•˜ì„¸ìš”
- ë¬¸ì¥ì„ ì¶©ë¶„íˆ ê¸¸ê²Œ ì‘ì„±í•˜ì—¬ ìƒì„¸í•œ ì„¤ëª…ì„ ì œê³µí•˜ì„¸ìš”
- ê° ë¬¸ë‹¨ì€ 5-7ë¬¸ì¥ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ì¶©ë¶„í•œ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”
- ìƒí’ˆ ì¶”ì²œ ê´€ë ¨ ì§ˆë¬¸ì—ëŠ” êµ¬ì²´ì ì¸ ìƒí’ˆëª…ê³¼ íŠ¹ì§•ì„ í¬í•¨í•˜ì—¬ ë‹µë³€í•˜ì„¸ìš”
- ì—°ë ¹ëŒ€ë³„ ê³ ê° íŠ¹ì„±ì„ ê³ ë ¤í•œ ë§ì¶¤í˜• ìƒí’ˆ ì¶”ì²œì„ ì œê³µí•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒí’ˆì˜ ê²½ìš° ê¸ˆë¦¬, í•œë„, ìƒí™˜ì¡°ê±´ ë“± êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ í¬í•¨í•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒë‹´ ì§ˆë¬¸ì—ëŠ” ì‹¤ì œ ëŒ€ì¶œ ìƒí’ˆì„ ì¶”ì²œí•˜ê³ , ì•Œë¦¼ ì„œë¹„ìŠ¤ë‚˜ ê¸°íƒ€ ì„œë¹„ìŠ¤ëŠ” ì¶”ì²œí•˜ì§€ ë§ˆì„¸ìš”
- ë‹µë³€ì„ ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ë‹¨ìœ¼ë¡œ êµ¬ì„±í•˜ì—¬ ê¸¸ê³  ìƒì„¸í•˜ê²Œ ì‘ì„±í•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒí’ˆ ì¶”ì²œ ì‹œì—ëŠ” êµ¬ì²´ì ì¸ ìƒí’ˆëª…(ê°€ê³„ëŒ€ì¶œ, ì£¼íƒë‹´ë³´ëŒ€ì¶œ, ì „ì›”ì„¸ë³´ì¦ê¸ˆëŒ€ì¶œ ë“±)ì„ ëª…ì‹œí•˜ì„¸ìš”
- 70ëŒ€ ê³ ê°ì—ê²ŒëŠ” ì—°ë ¹ëŒ€ì— ë§ëŠ” ëŒ€ì¶œ ìƒí’ˆì„ êµ¬ì²´ì ìœ¼ë¡œ ì¶”ì²œí•˜ì„¸ìš”
- ëŒ€ì¶œ ìƒë‹´ ì§ˆë¬¸ì—ëŠ” ë°˜ë“œì‹œ êµ¬ì²´ì ì¸ ëŒ€ì¶œ ìƒí’ˆëª…ì„ ì¶”ì²œí•˜ê³ , ë‹¨ê³„ë³„ ì„¤ëª…ì´ë‚˜ ì¼ë°˜ì ì¸ ì¡°ì–¸ì€ í”¼í•˜ì„¸ìš”
- ê³ ê°ì—ê²Œ ì§ì ‘ì ì¸ ëŒ€ì¶œ ìƒí’ˆ ì¶”ì²œì„ ì œê³µí•˜ì„¸ìš”

ë‹µë³€:
"""
        return await self.call_gpt(prompt)
    
    async def call_gpt(self, prompt: str) -> str:
        """GPT API í˜¸ì¶œ"""
        try:
            headers = {
                "Authorization": f"Bearer {self.api_key}",
                "Content-Type": "application/json"
            }
            
            data = {
                "model": "gpt-3.5-turbo",
                "messages": [{"role": "user", "content": prompt}],
                "temperature": 0.7,
                "max_tokens": 1000
            }
            
            response = requests.post(
                f"{self.base_url}/chat/completions",
                headers=headers,
                json=data,
                timeout=30
            )
            
            if response.status_code == 200:
                result = response.json()
                return result["choices"][0]["message"]["content"]
            else:
                return "ì£„ì†¡í•©ë‹ˆë‹¤. ë‹µë³€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
                
        except Exception as e:
            print(f"GPT API error: {e}")
            return "ì£„ì†¡í•©ë‹ˆë‹¤. ë‹µë³€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."
